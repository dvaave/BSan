<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
<title>DynamoRIO: Development Workflow</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DynamoRIO
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('page_workflow.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Development Workflow </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We use a centralized rebase workflow for our "master" branch combined with feature branches. Each commit destined for master is first pushed to a feature branch and then fast-forward-merged from there to master. Larger features are developed incrementally, split into small pieces with individual feature branches being fast-forward-merged into master.</p>
<p>No local changes should be made to the local "master" branch: all changes should occur on a feature branch. For simplicity, pulls and pushes are done directly on the feature branch, so normally the local "master" branch is rarely used.</p>
<p><a class="el" href="page_code_reviews.html">Code reviews use pull requests</a>.</p>
<h1><a class="anchor" id="autotoc_md306"></a>
Getting the Code</h1>
<p>Clone the repository, either via ssh if you've set up ssh keys in your Github profile:</p>
<div class="fragment"><div class="line">git clone git@github.com:DynamoRIO/dynamorio.git</div>
</div><!-- fragment --><p>Or via https:</p>
<div class="fragment"><div class="line">git clone https://github.com/DynamoRIO/dynamorio.git</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md307"></a>
Configuring Author Information and Aliases</h1>
<p>Before doing anything on a fresh clone, run the development setup script (commands for updating and for code reviews depend on it):</p>
<div class="fragment"><div class="line">make/git/devsetup.sh</div>
</div><!-- fragment --><p>Additionally, make sure that your full name is listed in the <code>Name</code> field at <a href="https://github.com/settings/profile">https://github.com/settings/profile</a> and that a legitimate email address that represents you is set as your primary Github address at <a href="https://github.com/settings/emails">https://github.com/settings/emails</a>. Those two fields will be used for the author line for pull requests when they are squash-and-merged into master. You must also uncheck <code>Keep my email address private</code> in the email settings page.</p>
<h1><a class="anchor" id="autotoc_md308"></a>
Working on a Small Feature or Bug Fix</h1>
<p>Small features or bug fixes, i.e., those that will become a single commit in the master branch, use "feature branches".</p>
<p>Ensure origin is up to date:</p>
<div class="fragment"><div class="line">git fetch origin</div>
</div><!-- fragment --><p>Then create a new branch for the feature or bug fix, called a "feature" branch. Replace "NNNN" with the issue number and "myfeature" with a name of your choice following the naming conventions below:</p>
<div class="fragment"><div class="line">git newbranch iNNNN-myfeature</div>
</div><!-- fragment --><p>Now perform your work in the feature branch, committing locally.</p>
<h1><a class="anchor" id="sec_branch_naming"></a>
Branch Naming Conventions</h1>
<p>For a small feature or bug fix, the name should start with the issue number prefixed by <code>i</code>, followed by a dash, followed by a short description. For example, <code>i2172-maps-parsing</code> or <code>i2157-reattach</code>. If there is no filed issue, use the <code>iX-</code> prefix. For example, <code>iX-fix-readme-typo</code>. If there will be multiple changes for an issue, create a different branch for each subsequent change, prefixing them with the same naming convention (i.e. <code>i</code> followed by issue number). For example: <code>i2172-refactoring-raw2trace</code>, <code>i2172-adding-wrappers</code>, etc. Note also the <a class="el" href="page_code_reviews.html#sec_commit_messages">change naming conventions</a> in such a case.</p>
<p>Although often a feature branch is short-lived, sometimes experimental work is not able to be finished immediately and there is value in sharing the code so that others can pick up on it. This is the logic behind using descriptive names for feature branches.</p>
<p>For an experimental branch (see below), the name should start with <code>experimental-</code>. For example, <code>experimental-jitopt</code>.</p>
<h1><a class="anchor" id="autotoc_md309"></a>
Merging upstream changes</h1>
<p>The <code>git pullall</code> alias runs a script that does the right type of update depending on whether you're in a feature branch that has not yet been pushed to the Github repository (where we want a rebase) or in a branch that has already been pushed (where we want to rebase from the remote feature branch and merge from the upstream master).</p>
<p>Thus, to update your current feature branch with the latest content in both the upstream master and in the remote feature branch, if it exists, simply execute:</p>
<div class="fragment"><div class="line">git pullall</div>
</div><!-- fragment --><p>After you've shared the branch for review, it is fine to not bother to update to master prior to the final merge, relying on Github's Update Branch button at the time of the merge. If you do need to update from master for some local testing, it's best to use a merge rather than a rebase to avoid losing history in the pull request, and <code>git pullall</code> will make sure that a merge is used. Don't worry about merge commits in feature branches: they'll be removed in the final squash-and-fast-forward-merge step onto master.</p>
<p>If you've pressed the Github button to update the feature branch with changes from master, and you now want to add a commit to your local branch (or have already added one), you want to pull the Github-added commit from the feature branch rather than master as a rebase. As mentioned, <code>git pullall</code> does that for you (along with updating from master).</p>
<h1><a class="anchor" id="autotoc_md310"></a>
Requesting a Code Review and Merging to Master</h1>
<p>Code reviews are requested by pushing the feature branch to Github and then creating a pull request onto master. See <a class="el" href="page_code_reviews.html">code review details here</a>. Merges to master occur only via pull request.</p>
<h1><a class="anchor" id="autotoc_md311"></a>
Deleting a Feature Branch</h1>
<p>Once your changes have been merged into master, you can delete your feature branch with these commands (substituting your branch's name for "feature"):</p>
<div class="fragment"><div class="line">git checkout master</div>
<div class="line">git pullall</div>
<div class="line">git branch -d feature</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md312"></a>
Checking Out an Existing Feature Branch</h1>
<p>You can check out an existing feature branch <code>iNNNN-name</code> via:</p>
<div class="fragment"><div class="line">git fetch origin</div>
<div class="line">git checkout iNNNN-name</div>
</div><!-- fragment --><p>This is equivalent to:</p>
<div class="fragment"><div class="line">git fetch origin</div>
<div class="line">git checkout -b iNNNN-name remotes/origin/iNNNN-name</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md313"></a>
Splitting Up a Feature Branch</h1>
<p>If you want to split off the first commit or two from a feature branch and you issue a command like this:</p>
<div class="fragment"><div class="line">git checkout -b tocheckin 35d4e9c87de22ec9b3a8a110cae2d83821c88ee0</div>
</div><!-- fragment --><p>The <code>tocheckin</code> branch will not be a tracking branch. You'll need to issue this command:</p>
<div class="fragment"><div class="line">git branch --set-upstream-to=origin/master tocheckin</div>
</div><!-- fragment --><p>If you've run the development setup script, you can run both commands at once with:</p>
<div class="fragment"><div class="line">git split tocheckin 35d4e9c87de22ec9b3a8a110cae2d83821c88ee0</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md314"></a>
Large Features or Projects</h1>
<p>For larger features or projects which will end up containing many commits, the workflow is unchanged. Work proceeds incrementally, with each small piece being committed to master using a feature branch and pull request.</p>
<h1><a class="anchor" id="autotoc_md315"></a>
Experimental Branches</h1>
<p>For experimental, quick-and-dirty work, especially where the work was already finished privately or where for time constraints and other reasons the regular development process is not suitable, we support experimental branches. The idea is to promote sharing of academic prototypes and other projects, with the goal of sharing the ideas immediately and making it more likely that the ideas will be eventually integrated into master, by separating the initial sharing from the later clean up and incremental code review. As described above, experimental branch names start with <code>experimental-</code>.</p>
<p>Please note that like other contributions, code contributed to an experimental branch is <a class="el" href="page_contributing.html">offered under the terms of our license</a>.</p>
<h1><a class="anchor" id="autotoc_md316"></a>
Useful Aliases</h1>
<p>Some potentially useful aliases that are not in the development setup script include the common tasks of looking at the log of changes versus the remote master:</p>
<div class="fragment"><div class="line">git config alias.dlog &quot;log --stat origin/master..&quot;</div>
</div><!-- fragment --><p>And looking at the full diff versus the remote master:</p>
<div class="fragment"><div class="line">git config alias.ddiff &quot;diff origin/master..&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md317"></a>
No Merge Commits on Master</h1>
<p>Our workflow uses fast-forward-merge and rebase when merging into the master branch. We do not want any merge commits on the master branch: we want a nice clean line of history. Merge commits on feature branches are fine as they will disappear upon merging into master. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer" style="float:none;text-align:center"><img border=0 src="favicon.png"> &nbsp;  DynamoRIO version 9.0.1 --- Mon Feb 14 2022 19:04:10 &nbsp; <img border=0 src="favicon.png">
</small></address>
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
