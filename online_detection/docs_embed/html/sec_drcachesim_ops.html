---
title: "Simulator Parameters"
layout: default
permalink: /sec_drcachesim_ops.html
---
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DynamoRIO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Simulator Parameters </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>drcachesim's</code> behavior can be controlled through options passed after the <code>-c</code> <code>drcachesim</code> but prior to the "--" delimiter on the command line:</p>
<div class="fragment"><div class="line">$ bin64/drrun -t drcachesim &lt;options&gt; &lt;to&gt; &lt;drcachesim&gt; -- /path/to/target/app &lt;args&gt; &lt;<span class="keywordflow">for</span>&gt; &lt;app&gt;</div>
</div><!-- fragment --><p>Boolean options can be disabled using a "-no_" prefix.</p>
<p>The parameters available are described below:</p>
<ul>
<li><b>-offline</b> <br  />
<em>default value: false</em> <br  />
By default, traces are processed online, sent over a pipe to a simulator. If this option is enabled, trace data is instead written to files in -outdir for later offline analysis. No simulator is executed.</li>
<li><b>-ipc_name</b> <br  />
<em>default value: drcachesimpipe</em> <br  />
For online tracing and simulation (the default, unless -offline is requested), specifies the name of the named pipe used to communicate between the target application processes and the caching device simulator. On Linux this can include an absolute path (if it doesn't, a default temp directory will be used). A unique name must be chosen for each instance of the simulator being run at any one time. On Windows, the name is limited to 247 characters.</li>
<li><b>-outdir</b> <br  />
<em>default value: .</em> <br  />
For the offline analysis mode (when -offline is requested), specifies the path to a directory where per-thread trace files will be written.</li>
<li><b>-subdir_prefix</b> <br  />
<em>default value: drmemtrace</em> <br  />
For the offline analysis mode (when -offline is requested), specifies the prefix for the name of the sub-directory where per-thread trace files will be written. The sub-directory is created inside -outdir and has the form 'prefix.app-name.pid.id.dir'.</li>
<li><b>-indir</b> <br  />
<em>default value: ""</em> <br  />
After a trace file is produced via -offline into -outdir, it can be passed to the simulator via this flag pointing at the subdirectory created in -outdir. The -offline tracing produces raw data files which are converted into final trace files on the first execution with -indir. The raw files can also be manually converted using the drraw2trace tool. Legacy single trace files with all threads interleaved into one are not supported with this option: use -infile instead.</li>
<li><b>-infile</b> <br  />
<em>default value: ""</em> <br  />
Directs the simulator to use a single all-threads-interleaved-into-one trace file. This is a legacy file format that is no longer produced.</li>
<li><b>-jobs</b> <br  />
<em>default value: -1</em> <br  />
By default, both post-processing of offline raw trace files and analysis of trace files is parallelized. This option controls the number of concurrent jobs. 0 disables concurrency and uses a single thread to perform all operations. A negative value sets the job count to the number of hardware threads, with a cap of 16.</li>
<li><b>-module_file</b> <br  />
<em>default value: ""</em> <br  />
The opcode_mix tool needs the modules.log file (generated by the offline post-processing step in the raw/ subdirectory) in addition to the trace file. If the file is named modules.log and is in the same directory as the trace file, or a raw/ subdirectory below the trace file, this parameter can be omitted.</li>
<li><b>-alt_module_dir</b> <br  />
<em>default value: ""</em> <br  />
Specifies a directory containing libraries referenced in -module_file for analysis tools, or in the raw modules file for post-prcoessing of offline raw trace files. This directory takes precedence over the recorded path.</li>
<li><b>-funclist_file</b> <br  />
<em>default value: ""</em> <br  />
The func_view tool needs the mapping from function name to identifier that was recorded during offline tracing. This data is stored in its own separate file in the raw/ subdirectory. If the file is named funclist.log and is in the same directory as the trace file, or a raw/ subdirectory below the trace file, this parameter can be omitted.</li>
<li><b>-cores</b> <br  />
<em>default value: 4</em> <br  />
Specifies the number of cores to simulate.</li>
<li><b>-line_size</b> <br  />
<em>default value: 64</em> <br  />
Specifies the cache line size, which is assumed to be identical for L1 and L2 caches. Must be a power of 2.</li>
<li><b>-L1I_size</b> <br  />
<em>default value: 32K</em> <br  />
Specifies the total size of each L1 instruction cache. Must be a power of 2 and a multiple of -line_size.</li>
<li><b>-L1D_size</b> <br  />
<em>default value: 32K</em> <br  />
Specifies the total size of each L1 data cache. Must be a power of 2 and a multiple of -line_size.</li>
<li><b>-L1I_assoc</b> <br  />
<em>default value: 8</em> <br  />
Specifies the associativity of each L1 instruction cache. Must be a power of 2.</li>
<li><b>-L1D_assoc</b> <br  />
<em>default value: 8</em> <br  />
Specifies the associativity of each L1 data cache. Must be a power of 2.</li>
<li><b>-LL_size</b> <br  />
<em>default value: 8M</em> <br  />
Specifies the total size of the unified last-level (L2) cache. Must be a power of 2 and a multiple of -line_size.</li>
<li><b>-LL_assoc</b> <br  />
<em>default value: 16</em> <br  />
Specifies the associativity of the unified last-level (L2) cache. Must be a power of 2.</li>
<li><b>-LL_miss_file</b> <br  />
<em>default value: ""</em> <br  />
If non-empty, when running the cache simulator, requests that every last-level cache miss be written to a file at the specified path. Each miss is written in text format as a &lt;program counter, address&gt; pair. If this tool is linked with zlib, the file is written in gzip-compressed format. If non-empty, when running the cache miss analyzer, requests that prefetching hints based on the miss analysis be written to the specified file. Each hint is written in text format as a &lt;program counter, stride, locality level&gt; tuple.</li>
<li><b>-L0_filter</b> <br  />
<em>default value: false</em> <br  />
Filters out instruction and data hits in a 'zero-level' cache during tracing itself, shrinking the final trace to only contain instruction and data accesses that miss in this initial cache. This cache is direct-mapped with sizes equal to -L0I_size and -L0D_size. It uses virtual addresses regardless of -use_physical. The dynamic (pre-filtered) per-thread instruction count is tracked and supplied via a <a class="el" href="trace__entry_8h.html#aa7f51b43d8f1e20dc45e3618684b15e9a94cc2db87863fcdcdf9163d8c9c2152e">TRACE_MARKER_TYPE_INSTRUCTION_COUNT</a> marker at thread buffer boundaries and at thread exit.</li>
<li><b>-L0I_size</b> <br  />
<em>default value: 32K</em> <br  />
Specifies the size of the 'zero-level' instruction cache for -L0_filter. Must be a power of 2 and a multiple of -line_size, unless it is set to 0, which disables instruction fetch entries from appearing in the trace.</li>
<li><b>-L0D_size</b> <br  />
<em>default value: 32K</em> <br  />
Specifies the size of the 'zero-level' data cache for -L0_filter. Must be a power of 2 and a multiple of -line_size, unless it is set to 0, which disables data entries from appearing in the trace.</li>
<li><b>-instr_only_trace</b> <br  />
<em>default value: false</em> <br  />
If -instr_only_trace, only instruction fetch entries are included in the trace and data entries are omitted.</li>
<li><b>-coherence</b> <br  />
<em>default value: false</em> <br  />
Writes to cache lines will invalidate other private caches that hold that line.</li>
<li><b>-use_physical</b> <br  />
<em>default value: false</em> <br  />
If available, the default virtual addresses will be translated to physical. This is not possible from user mode on all platforms. This is not supported with -offline at this time.</li>
<li><b>-virt2phys_freq</b> <br  />
<em>default value: 0</em> <br  />
This option only applies if -use_physical is enabled. The virtual to physical mapping is cached for performance reasons, yet the underlying mapping can change without notice. This option controls the frequency with which the cached value is ignored in order to re-access the actual mapping and ensure accurate results. The units are the number of memory accesses per forced access. A value of 0 uses the cached values for the entire application execution.</li>
<li><b>-cpu_scheduling</b> <br  />
<em>default value: false</em> <br  />
By default, the simulator schedules threads to simulated cores in a static round-robin fashion. This option causes the scheduler to instead use the recorded cpu that each thread executed on (at a granularity of the trace buffer size) for scheduling, mapping traced cpu's to cores and running each segment of each thread on the core that owns the recorded cpu for that segment.</li>
<li><b>-max_trace_size</b> <br  />
<em>default value: 0</em> <br  />
If non-zero, this sets a maximum size on the amount of raw trace data gathered for each thread. This is not an exact limit: it may be exceeded by the size of one internal buffer. Once reached, instrumentation continues for that thread, but no further data is recorded.</li>
<li><b>-max_global_trace_refs</b> <br  />
<em>default value: 0</em> <br  />
If non-zero, this sets a maximum size on the amount of trace entry references (of any type: instructions, loads, stores, markers, etc.) recorded. Once reached, instrumented execution continues, but no further data is recorded. This is similar to -exit_after_tracing but without terminating the process.The reference count is approximate.</li>
<li><b>-trace_after_instrs</b> <br  />
<em>default value: 0</em> <br  />
If non-zero, this causes tracing to be suppressed until this many dynamic instruction executions are observed. At that point, regular tracing is put into place. The threshold should be considered approximate, especially for larger values. Switching to regular tracing takes some amount of time during which other threads than the one that triggered the switch can continue to execute, resulting in a larger count of executed instructions before tracing actually starts than this given threshold. Use -max_trace_size or -max_global_trace_refs to set a limit on the subsequent trace length.</li>
<li><b>-exit_after_tracing</b> <br  />
<em>default value: 0</em> <br  />
If non-zero, after tracing the specified number of references, the process is exited with an exit code of 0. The reference count is approximate. Use -max_global_trace_refs instead to avoid terminating the process.</li>
<li><b>-online_instr_types</b> <br  />
<em>default value: false</em> <br  />
By default, offline traces include some information on the types of instructions, branches in particular. For online traces, this comes at a performance cost, so it is turned off by default.</li>
<li><b>-replace_policy</b> <br  />
<em>default value: LRU</em> <br  />
Specifies the replacement policy for caches. Supported policies: LRU (Least Recently Used), LFU (Least Frequently Used), FIFO (First-In-First-Out).</li>
<li><b>-data_prefetcher</b> <br  />
<em>default value: nextline</em> <br  />
Specifies the hardware data prefetcher policy. The currently supported policies are 'nextline' (fetch the subsequent cache line) and 'none' (disables hardware prefetching). The prefetcher is located between the L1D and LL caches.</li>
<li><b>-page_size</b> <br  />
<em>default value: 4K</em> <br  />
Specifies the virtual/physical page size.</li>
<li><b>-TLB_L1I_entries</b> <br  />
<em>default value: 32</em> <br  />
Specifies the number of entries in each L1 instruction TLB. Must be a power of 2.</li>
<li><b>-TLB_L1D_entries</b> <br  />
<em>default value: 32</em> <br  />
Specifies the number of entries in each L1 data TLB. Must be a power of 2.</li>
<li><b>-TLB_L1I_assoc</b> <br  />
<em>default value: 32</em> <br  />
Specifies the associativity of each L1 instruction TLB. Must be a power of 2.</li>
<li><b>-TLB_L1D_assoc</b> <br  />
<em>default value: 32</em> <br  />
Specifies the associativity of each L1 data TLB. Must be a power of 2.</li>
<li><b>-TLB_L2_entries</b> <br  />
<em>default value: 1024</em> <br  />
Specifies the number of entries in each unified L2 TLB. Must be a power of 2.</li>
<li><b>-TLB_L2_assoc</b> <br  />
<em>default value: 4</em> <br  />
Specifies the associativity of each unified L2 TLB. Must be a power of 2.</li>
<li><b>-TLB_replace_policy</b> <br  />
<em>default value: LFU</em> <br  />
Specifies the replacement policy for TLBs. Supported policies: LFU (Least Frequently Used).</li>
<li><b>-simulator_type</b> <br  />
<em>default value: cache</em> <br  />
Specifies the type of the simulator. Supported types: cache, miss_analyzer, TLB, reuse_distance, reuse_time, histogram, basic_counts, or invariant_checker.</li>
<li><b>-verbose</b> <br  />
<em>default value: 0</em> <br  />
Verbosity level for notifications.</li>
<li><b>-show_func_trace</b> <br  />
<em>default value: true</em> <br  />
In the func_trace tool, this controls whether every traced call is shown or instead only aggregate statistics are shown.</li>
<li><b>-test_mode</b> <br  />
<em>default value: false</em> <br  />
Run extra analyses for sanity checks on the trace.</li>
<li><b>-test_mode_name</b> <br  />
<em>default value: ""</em> <br  />
Run extra analyses for specific sanity checks by name on the trace.</li>
<li><b>-disable_optimizations</b> <br  />
<em>default value: false</em> <br  />
Disables various optimizations where information is omitted from offline trace recording when it can be reconstructed during post-processing. This is meant for testing purposes.</li>
<li><b>-dr</b> <br  />
<em>default value: ""</em> <br  />
Specifies the path of the DynamoRIO root directory.</li>
<li><b>-dr_debug</b> <br  />
<em>default value: false</em> <br  />
Requests use of the debug build of DynamoRIO rather than the release build.</li>
<li><b>-dr_ops</b> <br  />
<em>default value: ""</em> <br  />
Specifies the options to pass to DynamoRIO.</li>
<li><b>-tracer</b> <br  />
<em>default value: ""</em> <br  />
The full path to the tracer library.</li>
<li><b>-tracer_alt</b> <br  />
<em>default value: ""</em> <br  />
The full path to the tracer library for the other bitwidth, for use on child processes with a different bitwidth from their parent. If empty, such child processes will die with fatal errors.</li>
<li><b>-only_thread</b> <br  />
<em>default value: 0</em> <br  />
For simulator types that support it, limits analyis to the single thread with the given identifier. 0 enables all threads.</li>
<li><b>-skip_refs</b> <br  />
<em>default value: 0</em> <br  />
Specifies the number of references to skip in the beginning of the application execution. These memory references are dropped instead of being simulated.</li>
<li><b>-warmup_refs</b> <br  />
<em>default value: 0</em> <br  />
Specifies the number of memory references to warm up caches before simulation. The warmup references come after the skipped references and before the simulated references. This flag is incompatible with warmup_fraction.</li>
<li><b>-warmup_fraction</b> <br  />
<em>default value: 0</em> <br  />
Specifies the fraction of last level cache blocks to be loaded such that the cache is considered to be warmed up before simulation. The warmup fraction is computed after the skipped references and before simulated references. This flag is incompatible with warmup_refs.</li>
<li><b>-sim_refs</b> <br  />
<em>default value: 8589934592G</em> <br  />
Specifies the number of memory references to simulate. The simulated references come after the skipped and warmup references, and the references following the simulated ones are dropped.</li>
<li><b>-view_syntax</b> <br  />
<em>default value: att/arm/dr</em> <br  />
Specifies the syntax to use when viewing disassembled offline traces. The option can be set to one of "att" (AT&amp;T style), "intel" (Intel style), "dr" (DynamoRIO's native style with all implicit operands listed), and "arm" (32-bit ARM style). An invalid specification falls back to the default, which is "att" for x86, "arm" for ARM (32-bit), and "dr" for AArch64.</li>
<li><b>-config_file</b> <br  />
<em>default value: ""</em> <br  />
The full path to the cache hierarchy configuration file.</li>
<li><b>-report_top</b> <br  />
<em>default value: 10</em> <br  />
Specifies the number of top results to be reported.</li>
<li><b>-reuse_distance_threshold</b> <br  />
<em>default value: 100</em> <br  />
Specifies the reuse distance threshold for reporting the distant repeated references. A reference is a distant repeated reference if the distance to the previous reference on the same cache line exceeds the threshold.</li>
<li><b>-reuse_distance_histogram</b> <br  />
<em>default value: false</em> <br  />
By default only the mean, median, and standard deviation of the reuse distances are reported. This option prints out the full histogram of reuse distances.</li>
<li><b>-reuse_skip_dist</b> <br  />
<em>default value: 500</em> <br  />
Specifies the distance between nodes in the skip list. For optimal performance, set this to a value close to the estimated average reuse distance of the dataset.</li>
<li><b>-reuse_verify_skip</b> <br  />
<em>default value: false</em> <br  />
Verifies every skip list-calculated reuse distance with a full list walk. This incurs significant additional overhead. This option is only available in debug builds.</li>
<li><b>-record_function</b> <br  />
<em>default value: ""</em> <br  />
Record invocations trace for the specified function(s) in the option value. Default value is empty. The value should fit this format: function_name|func_args_num (e.g., -record_function "memset|3") with an optional suffix "|noret" (e.g., -record_function "free|1|noret"). The trace would contain information for each function invocation's return address, function argument value(s), and (unless "|noret" is specified) function return value. (If multiple requested functions map to the same address and differ in whether "noret" was specified, the attribute from the first one requested will be used. If they differ in the number of args, the minimum value will be used.) We only record pointer-sized arguments and return values. The trace identifies which function is involved via a numeric ID entry prior to each set of value entries. The mapping from numeric ID to library-qualified symbolic name is recorded during tracing in a file "funclist.log" whose format is described by the <a class="el" href="drmemtrace_8h.html#abc71b61ef30155adbc03800ce7597261">drmemtrace_get_funclist_path()</a> function's documentation. If the target function is in the dynamic symbol table, then the function_name should be a mangled name (e.g. "_Znwm" for "operator new", "_ZdlPv" for "operator delete"). Otherwise, the function_name should be a demangled name. Recording multiple functions can be achieved by using the separator "&amp;" (e.g., -record_function "memset|3&amp;memcpy|3"), or specifying multiple -record_function options (e.g., -record_function "memset|3" -record_function "memcpy|3"). Note that the provided function name should be unique, and not collide with existing heap functions (see -record_heap_value) if -record_heap option is enabled.</li>
<li><b>-record_heap</b> <br  />
<em>default value: false</em> <br  />
It is a convenience option to enable recording a trace for the defined heap functions in -record_heap_value. Specifying this option is equivalent to -record_function [heap_functions], where [heap_functions] is the value in -record_heap_value.</li>
<li><b>-record_heap_value</b> <br  />
<em>default value: malloc|1&amp;free|1|noret&amp;tc_malloc|1&amp;tc_free|1|noret&amp;__libc_malloc|1&amp;__libc_free|1|noret&amp;calloc|2&amp;_Znwm|1&amp;_ZnwmRKSt9nothrow_t|2&amp;_ZnwmSt11align_val_t|2&amp;_ZnwmSt11align_val_tRKSt9nothrow_t|3&amp;_ZnwmPv|2&amp;_Znam|1&amp;_ZnamRKSt9nothrow_t|2&amp;_ZnamSt11align_val_t|2&amp;_ZnamSt11align_val_tRKSt9nothrow_t|3&amp;_ZnamPv|2&amp;_ZdlPv|1|noret&amp;_ZdlPvRKSt9nothrow_t|2|noret&amp;_ZdlPvSt11align_val_t|2|noret&amp;_ZdlPvSt11align_val_tRKSt9nothrow_t|3|noret&amp;_ZdlPvm|2|noret&amp;_ZdlPvmSt11align_val_t|3|noret&amp;_ZdlPvS_|2|noret&amp;_ZdaPv|1|noret&amp;_ZdaPvRKSt9nothrow_t|2|noret&amp;_ZdaPvSt11align_val_t|2|noret&amp;_ZdaPvSt11align_val_tRKSt9nothrow_t|3|noret&amp;_ZdaPvm|2|noret&amp;_ZdaPvmSt11align_val_t|3|noret&amp;_ZdaPvS_|2|noret</em> <br  />
Functions recorded by -record_heap. The option value should fit the same format required by -record_function. These functions will not be traced unless -record_heap is specified.</li>
<li><b>-record_dynsym_only</b> <br  />
<em>default value: false</em> <br  />
Symbol lookup can be expensive for large applications and libraries. This option causes the symbol lookup for -record_function and -record_heap to look in the dynamic symbol table <em>only</em>.</li>
<li><b>-record_replace_retaddr</b> <br  />
<em>default value: false</em> <br  />
Function wrapping can be expensive for large concurrent applications. This option causes the post-function control point to be located using return address replacement, which has lower overhead, but runs the risk of breaking an application that examines or changes its own return addresses in the recorded functions.</li>
<li><b>-miss_count_threshold</b> <br  />
<em>default value: 50000</em> <br  />
Specifies the minimum number of LLC misses of a load for it to be eligible for analysis in search of patterns in the miss address stream.</li>
<li><b>-miss_frac_threshold</b> <br  />
<em>default value: 0.005</em> <br  />
Specifies the minimum fraction of LLC misses of a load (from all misses) for it to be eligible for analysis in search of patterns in the miss address stream.</li>
<li><b>-confidence_threshold</b> <br  />
<em>default value: 0.75</em> <br  />
Specifies the minimum confidence to include a discovered pattern in the output results. Confidence in a discovered pattern for a load instruction is calculated as the fraction of the load's misses with the discovered pattern over all the load's misses.</li>
<li><b>-enable_drstatecmp</b> <br  />
<em>default value: false</em> <br  />
When true, this option enables the drstatecmp library that performs state comparisons to detect instrumentation-induced bugs due to state clobbering. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<!--BEGIN GENERATE_TREEVIEW-->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer" style="float:none;text-align:center"><img border=0 src="favicon.png"> &nbsp;  DynamoRIO version 9.0.1 --- Mon Feb 14 2022 19:04:14 &nbsp; <img border=0 src="favicon.png">
</small></address>
